---
title: "CKME136_capstone_covidONT"
author: "ColbertTa"
date: "29/06/2020"
output: pdf_document
---

```{r setup, include=FALSE}
setwd("C:/Users/Colbert/OneDrive/Documents/CKME_136")
data <- read.csv(file = "conposcovidloc.csv", header = TRUE, sep = ",")
#install.packages("ggplot2")
library(ggplot2)
#install.packages("plyr")
library(plyr)
#tinytex::install_tinytex()
#install.packages("lubridate")
library(lubridate)


```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r data}
dim(data)
summary(data)


str(data)

#removing certain factors to clean data
clean<-data[!grepl("Not Resolved", data$Outcome1),]
clean<-clean[!grepl("Unknown", clean$Age_Group),]
clean<-clean[!grepl("UNKNOWN", clean$Client_Gender),]
clean<-clean[!grepl("OTHER", clean$Client_Gender),]
clean<-clean[!grepl("TRANSGENDER", clean$Client_Gender),]

names(clean)[2] <- "Date"
names(clean)[3] <- "Age"
names(clean)[4] <- "Gender"
names(clean)[5] <- "Info"
names(clean)[6] <- "Outcome"
names(clean)[8] <- "PHU"

clean$Date <- as.Date(clean$Date)
clean$Month <- floor_date(clean$Date, "month")
clean$Month <- as.factor(clean$Month)

```

## Including Plots

You can also embed plots, for example:

```{r clean, echo=FALSE}
ggplot(clean, aes(y=PHU)) + 
  geom_bar(aes(fill = Gender))

ggplot(clean, aes(x=Age)) + 
  geom_bar(aes(fill = Gender))

ggplot(clean, aes(y=Date)) + 
  geom_bar(aes(fill = Gender))

ggplot(clean, aes(y=Date)) + 
  geom_bar(aes(fill = Outcome))

ggplot(clean, aes(y=PHU)) + 
  geom_bar(aes(fill = Outcome))

ggplot(clean, aes(x=Gender)) + 
  geom_bar(aes(fill = Outcome))

ggplot(clean, aes(x=Age)) + 
  geom_bar(aes(fill = Outcome))

ggplot(clean, aes(y=Date)) + 
  geom_bar(aes(fill = PHU))

ggplot(clean, aes(y=PHU)) + 
  geom_bar(aes(fill = Age))

ggplot(clean, aes(y=Date)) + 
  geom_bar(aes(fill = Age))

ggplot(clean, aes(x=Month)) + 
  geom_bar(aes(fill = Outcome))
```

```{r}
#have to re-run the cleaning code, else type conversion doesn't work
clean<-data[!grepl("Not Resolved", data$Outcome1),]
clean<-clean[!grepl("Unknown", clean$Age_Group),]
clean<-clean[!grepl("UNKNOWN", clean$Client_Gender),]
clean<-clean[!grepl("OTHER", clean$Client_Gender),]
clean<-clean[!grepl("TRANSGENDER", clean$Client_Gender),]

#re-naming columns for easier coding
names(clean)[2] <- "Date"
names(clean)[3] <- "Age"
names(clean)[4] <- "Gender"
names(clean)[5] <- "Info"
names(clean)[6] <- "Outcome"
names(clean)[8] <- "PHU"

clean$Date <- as.Date(clean$Date)
clean$PHU <- as.numeric(clean$PHU)
clean$Age <- as.numeric(clean$Age)
clean$Gender <- as.numeric(clean$Gender)
clean$Outcome <- ifelse(clean$Outcome == "Resolved",1,0)
clean$Month <- floor_date(clean$Date, "month")

str(clean)

glmOutcome = glm(Outcome~Month+Age+Gender+PHU, clean, family=binomial)
summary(glmOutcome) #Age and Gender are good predictors of Outcome. PHU and Date are not good predictors with linear regression because there are too many data points 


```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
